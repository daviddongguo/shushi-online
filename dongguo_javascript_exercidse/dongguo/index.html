<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Sushi Expert</title>
	<link rel="icon" type="image/x-icon" href="favicon.ico" />
	<script type="text/javascript" src="script.js"></script>
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.css" />
	<!-- Compiled and minified CSS -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

	<!-- Compiled and minified JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

<body>

	<div>
		<h2>Exrs 1 : check Prime</h2>
		<h6 id="primeMsg">Please enter an integer</h6>
		<input id="checkPrimeButton" type="text" onchange="checkPrime()">
	</div>
	<div>
		<h2>Exrs 2 : Registration from</h2>
		<div>
			<h6 id="registrationMsg">Please register</h6>

			<label for="email">email:</label><br>
			<input type="text" id="email" value="email@email.com"><br>
			<label for="password">password:</label><br>
			<input type="text" id="password" value="*.*">
			<input id="registerButton" type="submit" onclick="register()" value="Register">
		</div>
	</div>

	<div>
		<h2>Exrs 3 : print fibonacci on console</h2>
		<input type="button" value="print fibonacci" onclick="printFibonacci(15)">
	</div>

	<div>
		<h1 id="msg">hi, there</h1>
		<h3>This is an input</h3>
		<input id="myNumber" type="text" onchange="numberChanged()" oninput="numberChanging()">
		<p>This is a paragraph.</p>
		<input type="submit" text="click me" onclick="submitClicked()">
		<hr>
		<div>
			<label for="number1">number 1:</label><br>
			<input type="text" id="number1" value="9"><br>
			<label for="number2">number 2:</label><br>
			<input type="text" id="number2" value="3">
			<input type="submit" onclick="multiplyClicked()" value="Multiply">
			<input type="submit" onclick="divideClicked()" value="Divide">
			<input type="submit" onclick="addClicked()" value="Add">
			<input type="submit" onclick="subtractClicked()" value="Subtract">
		</div>
		<div>
			<h3>The result is: </h3>
			<h3 id="result">...</h3>
		</div>


		<div>
			<form id="image-upload-form" method="POST" enctype="multipart/form-data">
				<div>
					<label for="name">Name</label>
					<input type="text" name="name" id="name" value="name" required>
				</div>
				<div>
					<label for="description">Description</label>
					<input type="text" name="description" value="description" id="description">
				</div>
				<div>
					<label for="image">Image</label>
					<input type="file" name="file" id="file" required>
				</div>
				<img src="" alt="" />
				<button type="submit">Upload</button>
			</form>
		</div>

	</div>

	<div>
		<img src="" alt="" id="img">
		<button onclick="getImage()">get image</button>
	</div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>


	<script>

		function getImage() {
			var xhr = new XMLHttpRequest();
			// xhr.open("POST", "http://localhost:8080/images/3/view", true);
			xhr.open("POST", "http://dongguo.xyz:8080/images/16/view", true);
			xhr.responseType = "arraybuffer";
			xhr.onload = function (event) {
				if (xhr.status === 200) {
					var blob = new Blob([xhr.response], { type: "image/jpeg" });

					var reader = new FileReader();
					reader.readAsDataURL(blob);
					reader.onload = function () {
						var img = document.createElement("img");
						img.src = reader.result;
						document.body.appendChild(img);
					};
				} else {
					console.log("Error loading image.");
				}
			};

			xhr.send(null);
		}



		var el = document.getElementById("file")
		el.addEventListener('change', function (e) {
			console.log(this)
			console.log(e.target)
			let files = e.target.files
			console.log(files)
			if (!files.length) return

			file = files[0]
			previewFile(files[0])
			formData = new FormData()
			formData.append('name', 'name')
			formData.append('description', 'name')
			formData.append('file', files[0], files[0].name)
			console.log(formData)
			axios({
				method: "post",
				url: "http://localhost:8080/images",
				data: formData,
				headers: { "Content-Type": "multipart/form-data" },
			})
				.then(function (response) {
					console.log(response);
				})
				.catch(function (response) {
					console.log(response);
				});

		})


		function previewFile(file) {
			let reader
			if (file) {
				reader = new FileReader()
				reader.readAsDataURL(file)
			}
			reader.onload = function (e) {
			document.querySelector('img').src = e.target.result
			}
		}


			</script>
</body>

</html>
